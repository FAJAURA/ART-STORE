<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fajaura Art Shop — Handmade & Cute</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
<style>
  :root{
    --cream:#fffaf5;
    --peach:#ffd6a5;
    --blush:#ffe5ec;
    --mint:#c8e7d0;
    --brown:#6d4c41;
    --accent:#e85a4f;
    --card-border: rgba(109,76,65,0.08);
  }
  *{box-sizing:border-box}
  body{
    font-family:"Poppins",sans-serif;
    margin:0;
    background: linear-gradient(180deg,var(--cream) 0%, #fff 100%);
    color:var(--brown);
  }

  header{
    background: linear-gradient(90deg,var(--peach),var(--blush));
    padding:20px;
    text-align:center;
    position:sticky;
    top:0;
    z-index:40;
    box-shadow:0 3px 10px rgba(0,0,0,0.05);
    display:flex;
    gap:20px;
    align-items:center;
    justify-content:space-between;
  }
  .brand {
    display:flex;
    gap:12px;
    align-items:center;
    margin-left:12px;
  }
  .logo{
    width:46px;height:46px;border-radius:12px;
    background:linear-gradient(135deg,#fff,#ffd6a5);
    display:flex;align-items:center;justify-content:center;
    border:2px dashed rgba(0,0,0,0.03);
    font-weight:700;color:var(--brown);
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
  }
  .brand h1{margin:0;font-size:1.25rem;color:var(--brown)}
  .top-right{
    display:flex;gap:10px;align-items:center;margin-right:12px;
  }
  .btn {
    background:transparent;border:1px solid rgba(109,76,65,0.12);
    padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:600;
  }
  .btn.primary{
    background:var(--accent);color:#fff;border:none;
    box-shadow:0 6px 18px rgba(232,90,79,0.12);
  }

  .banner{
    max-width:1200px;margin:18px auto;padding:28px;border-radius:14px;
    display:flex;gap:20px;align-items:center;justify-content:space-between;
  }
  .hero {
    flex:1;
    padding:12px;
  }
  .hero h2{
    font-size:2.1rem;margin:0 0 10px;color:var(--brown);
  }
  .hero p{margin:0 0 14px;color:#5a3f37;opacity:0.9}
  .hero .shop{
    display:inline-block;padding:10px 18px;border-radius:30px;border:2px solid #fff;background:rgba(255,255,255,0.15);
    color:#fff;font-weight:700;text-decoration:none;
  }

  main{max-width:1200px;margin:12px auto;padding:0 16px 80px;}

  /* catalogs */
  .catalog{
    margin:26px 0;
  }
  .catalog h3{
    margin:0 0 12px;font-size:1.4rem;color:var(--brown);display:flex;align-items:center;gap:10px;
  }
  .catalog .meta{font-size:0.9rem;color:#70524b;opacity:0.9}

  .grid{
    display:grid;
    grid-template-columns: repeat(auto-fit,minmax(210px,1fr));
    gap:16px;
  }

  .card{
    background:#fff;border-radius:14px;padding:10px;border:1px solid var(--card-border);
    box-shadow: 0 8px 24px rgba(0,0,0,0.03);position:relative;
    user-select:none;
  }
  .card.dragging{opacity:0.6;transform:scale(0.98)}
  .card img{width:100%;height:160px;object-fit:cover;border-radius:10px}
  .card .info{padding:8px 4px;text-align:left}
  .card h4{margin:6px 0 4px;font-size:1rem;color:var(--brown)}
  .card p{margin:0;font-size:0.95rem;color:#55403a}
  .price{font-weight:700;margin-top:8px;color:var(--accent)}
  .card .actions{display:flex;gap:8px;margin-top:10px;align-items:center}
  .small{font-size:0.85rem;padding:6px 8px;border-radius:8px;border:1px dashed rgba(0,0,0,0.05);cursor:pointer}

  /* doodles */
  .doodle{
    font-size:1.2rem;margin-right:8px;opacity:0.9;
  }

  /* cart sidebar */
  .cart-toggle{cursor:pointer}
  .cart {
    position:fixed;right:14px;top:80px;width:360px;max-width:calc(100% - 32px);
    background:linear-gradient(180deg,#fff,#fffaf5);
    border-radius:14px;padding:12px;border:1px solid rgba(0,0,0,0.06);
    box-shadow:0 20px 50px rgba(0,0,0,0.12);z-index:60;
  }
  .cart h4{margin:6px 0 10px}
  .cart .items{max-height:350px;overflow:auto;margin-bottom:12px}
  .cart .row{display:flex;gap:8px;align-items:center;margin-bottom:8px}
  .cart .row img{width:52px;height:52px;border-radius:8px;object-fit:cover}
  .qty{display:flex;gap:6px;align-items:center}
  .total{font-weight:800;color:var(--brown);font-size:1.05rem}
  .small-muted{font-size:0.85rem;color:#6b4f47;opacity:0.9}

  /* top tool area */
  .tools{display:flex;gap:8px;align-items:center;justify-content:flex-end;margin:14px 0}
  .save {background:#fff;border:1px solid rgba(0,0,0,0.06);padding:8px;border-radius:10px;cursor:pointer}
  .import-export{display:flex;gap:8px;align-items:center}

  /* responsive */
  @media (max-width:700px){
    header{flex-direction:column;gap:8px;padding:12px}
    .hero h2{font-size:1.5rem}
    .cart{position:fixed;left:8px;right:8px;top:auto;bottom:12px;width:auto}
  }
</style>
</head>
<body>

<header>
  <div class="brand">
    <div class="logo">FA</div>
    <div>
      <h1>Fajaura</h1>
      <div style="font-size:0.85rem;color:#6b4f47">Handmade • Cute • Pastel</div>
    </div>
  </div>

  <div class="top-right">
    <div style="font-size:0.9rem;color:#6b4f47">PKR ↔ USD: <span id="rateDisplay">1 USD = 300 PKR</span></div>
    <button class="btn" id="exportBtn" title="Export site data (backup)">Export</button>
    <button class="btn" id="importBtn" title="Import site data (restore)">Import</button>
    <button class="btn save" id="resetBtn" title="Reset to demo">Reset</button>
    <button class="btn primary" id="openCart">Cart (<span id="cartCount">0</span>)</button>
  </div>
</header>

<div class="banner" style="max-width:1200px;margin:20px auto;">
  <div class="hero">
    <h2>the original best-selling doodle art</h2>
    <p>Handmade characters, digital brushes, prints and stickers — pick your favorite!</p>
    <div style="margin-top:8px">
      <button class="btn primary" onclick="document.getElementById('all').scrollIntoView({behavior:'smooth'})">Shop All</button>
    </div>
  </div>
  <div style="width:360px;height:160px;border-radius:10px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,0.06)">
    <img src="https://via.placeholder.com/600x320" style="width:100%;height:100%;object-fit:cover" alt="banner art">
  </div>
</div>

<main id="all">

  <div class="tools" style="max-width:1200px;margin:0 auto">
    <div class="import-export">
      <label style="font-size:0.9rem;color:#6b4f47">Edit mode: </label>
      <button class="btn" id="toggleEdit">Enable</button>
    </div>
  </div>

  <!-- catalogs will be injected here -->
</main>

<!-- cart (hidden by default) -->
<div class="cart" id="cartSide" style="display:none">
  <h4>Shopping Cart</h4>
  <div class="items" id="cartItems"></div>
  <div style="display:flex;justify-content:space-between;align-items:center">
    <div class="small-muted">Total</div>
    <div class="total" id="cartTotal">PKR 0 • $0.00</div>
  </div>
  <div style="margin-top:10px;display:flex;gap:8px">
    <button class="btn" id="clearCart">Clear</button>
    <button class="btn primary" id="checkoutBtn">Checkout (Demo)</button>
  </div>
</div>

<footer style="margin-top:40px;text-align:center;padding:18px;background:linear-gradient(90deg,var(--peach),var(--blush));color:var(--brown)">
  © <span id="year"></span> Fajaura — Made with ❤️ doodles
</footer>

<script>
/* ---------------------------
  Demo data (you can edit)
---------------------------- */
const DEFAULT_RATE = 300; // PKR per USD
const CATALOG_NAMES = [
  "art pieces",
  "stickers",
  "prints & portraits",
  "digital products",
  "handmade products",
  "many more"
];

function createDemoProducts() {
  const output = {};
  CATALOG_NAMES.forEach((cat,ci)=>{
    output[cat] = [];
    for(let i=1;i<=5;i++){
      output[cat].push({
        id: `${ci}-${i}`,
        title: `${cat.split(' ')[0].slice(0,1).toUpperCase()} ${i}`,
        img: "https://via.placeholder.com/400x300?text=Artwork+"+encodeURIComponent(i),
        pkr: Math.round(1000 + Math.random()*6000),
      });
    }
  });
  return output;
}

/* ---------------------------
  State & storage
---------------------------- */
const STORAGE_KEY = "fajaura_shop_data_v1";
let state = {
  rate: DEFAULT_RATE,
  catalogs: createDemoProducts(),
  cart: {}
};

function loadState(){
  const raw = localStorage.getItem(STORAGE_KEY);
  if(raw){
    try{
      state = JSON.parse(raw);
      if(!state.catalogs) state.catalogs = createDemoProducts();
      if(!state.cart) state.cart = {};
    }catch(e){
      state = {...state, catalogs: createDemoProducts()};
    }
  } else {
    state.catalogs = createDemoProducts();
  }
}
function saveState(){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  updateCartUI();
}

/* ---------------------------
  Render UI
---------------------------- */
const main = document.querySelector("main");
function renderAll(){
  document.getElementById("year").textContent = new Date().getFullYear();
  document.getElementById("rateDisplay").textContent = `1 USD = ${state.rate} PKR`;
  // clear existing catalogs
  const existing = document.querySelectorAll(".catalog");
  existing.forEach(e=>e.remove());
  // build catalogs
  Object.keys(state.catalogs).forEach(cat=>{
    const section = document.createElement("section");
    section.className = "catalog";
    section.dataset.cat = cat;
    const title = document.createElement("h3");
    title.innerHTML = `<span class="doodle">✦</span> ${capitalize(cat)} <span class="meta">— ${state.catalogs[cat].length} items</span>`;
    section.appendChild(title);

    const grid = document.createElement("div");
    grid.className="grid";
    grid.dataset.cat = cat;

    // allow drop on grid to reorder/add images
    makeGridDroppable(grid);

    state.catalogs[cat].forEach(prod=>{
      const card = createCard(prod,cat);
      grid.appendChild(card);
    });
    section.appendChild(grid);

    // tools under each section
    const tools = document.createElement("div");
    tools.style.margin="10px 0";
    const addBtn = document.createElement("button");
    addBtn.className="btn";
    addBtn.textContent="Add product";
    addBtn.onclick = ()=>{
      const id = Date.now();
      const newP = { id: `${cat}-${id}`, title: `New Item`, img: "https://via.placeholder.com/400x300?text=new", pkr: 1200 };
      state.catalogs[cat].push(newP);
      saveState(); renderAll();
    };
    tools.appendChild(addBtn);
    section.appendChild(tools);

    main.appendChild(section);
  });
  updateCartUI();
}

function createCard(prod,cat){
  const card = document.createElement("div");
  card.className = "card";
  card.draggable = true;
  card.dataset.id = prod.id;
  card.dataset.cat = cat;

  // drag handlers
  card.addEventListener('dragstart', (e)=>{
    card.classList.add('dragging');
    e.dataTransfer.setData('text/plain', JSON.stringify({id:prod.id,cat}));
  });
  card.addEventListener('dragend', ()=>card.classList.remove('dragging'));

  // image area (supports drop to replace image)
  const img = document.createElement('img');
  img.src = prod.img;
  img.alt = prod.title;
  img.title = "Drag an image file here to replace";
  img.addEventListener('dragover', (ev)=>ev.preventDefault());
  img.addEventListener('drop', (ev)=>{
    ev.preventDefault();
    const file = ev.dataTransfer.files[0];
    if(file && file.type.startsWith('image/')){
      const reader = new FileReader();
      reader.onload = e=>{
        img.src = e.target.result;
        // update state
        const arr = state.catalogs[cat];
        const p = arr.find(x=>x.id===prod.id);
        if(p) p.img = e.target.result;
        saveState();
      }
      reader.readAsDataURL(file);
    }
  });

  const info = document.createElement('div');
  info.className="info";

  const h4 = document.createElement('h4');
  h4.contentEditable = false;
  h4.innerText = prod.title;
  h4.title = "Double-click to edit title";
  h4.addEventListener('dblclick', ()=>{ h4.contentEditable=true; h4.focus(); });
  h4.addEventListener('blur', ()=>{
    h4.contentEditable=false;
    const arr = state.catalogs[cat]; const p = arr.find(x=>x.id===prod.id);
    if(p){ p.title = h4.innerText; saveState(); }
  });

  const p = document.createElement('p');
  p.innerText = "Item description";
  p.contentEditable = false;
  p.title = "Double-click to edit description";
  p.addEventListener('dblclick', ()=>{ p.contentEditable=true; p.focus(); });
  p.addEventListener('blur', ()=>{
    p.contentEditable=false;
    // we don't store desc in demo, optionally add
  });

  const price = document.createElement('div');
  price.className = "price";
  price.contentEditable = false;
  price.innerText = `PKR ${prod.pkr} • $${(prod.pkr/state.rate).toFixed(2)}`;
  price.title = "Double-click to edit PKR price";
  price.addEventListener('dblclick', ()=>{ price.contentEditable=true; price.focus(); });
  price.addEventListener('blur', ()=>{
    price.contentEditable=false;
    // parse PKR from string
    const txt = price.innerText.replace(/,/g,'').trim();
    const m = txt.match(/PKR\s*([\d.]+)/i);
    if(m){
      const newp = Math.round(Number(m[1]));
      const arr = state.catalogs[cat]; const pidx = arr.findIndex(x=>x.id===prod.id);
      if(pidx>-1){ arr[pidx].pkr = newp; saveState(); renderAll(); }
    } else {
      // show fallback
      price.innerText = `PKR ${prod.pkr} • $${(prod.pkr/state.rate).toFixed(2)}`;
    }
  });

  const actions = document.createElement('div');
  actions.className = "actions";
  const addBtn = document.createElement('button');
  addBtn.className = "small primary";
  addBtn.textContent = "Add";
  addBtn.onclick = ()=>{ addToCart(prod,cat); };

  const editHint = document.createElement('div');
  editHint.className = "small";
  editHint.textContent = "Drag image here";

  actions.appendChild(addBtn);
  actions.appendChild(editHint);

  info.appendChild(h4);
  info.appendChild(p);
  info.appendChild(price);
  info.appendChild(actions);

  card.appendChild(img);
  card.appendChild(info);

  // allow dropping card onto another grid to reorder
  card.addEventListener('dragover', (e)=>e.preventDefault());
  card.addEventListener('drop', (e)=>{
    e.preventDefault();
    const raw = e.dataTransfer.getData('text/plain');
    try{
      const data = JSON.parse(raw);
      if(data && data.id){
        // find source and move before this prod
        const sourceCat = data.cat;
        const sourceId = data.id;
        if(sourceCat && sourceId){
          const srcArr = state.catalogs[sourceCat];
          const srcIdx = srcArr.findIndex(x=>x.id===sourceId);
          const destArr = state.catalogs[cat];
          const destIdx = destArr.findIndex(x=>x.id===prod.id);
          if(srcIdx>-1 && destIdx>-1){
            // remove
            const [item] = srcArr.splice(srcIdx,1);
            // if same array and source index < dest index adjust dest idx
            if(sourceCat===cat && srcIdx < destIdx) destIdx--;
            destArr.splice(destIdx,0,item);
            saveState(); renderAll();
          }
        }
      }
    }catch(e){}
  });

  return card;
}

/* make grid accept file drops and reorder area */
function makeGridDroppable(grid){
  grid.addEventListener('dragover', (e)=>e.preventDefault());
  grid.addEventListener('drop', (e)=>{
    e.preventDefault();
    const raw = e.dataTransfer.getData('text/plain');
    // if image file dropped onto grid (not card)
    if(e.dataTransfer.files && e.dataTransfer.files.length>0){
      const file = e.dataTransfer.files[0];
      if(file.type && file.type.startsWith('image/')){
        const reader = new FileReader();
        reader.onload = evt=>{
          // create a new product with this image
          const cat = grid.dataset.cat;
          const id = `${cat}-${Date.now()}`;
          const newP = { id, title: "New Image", img: evt.target.result, pkr: 1200 };
          state.catalogs[cat].push(newP);
          saveState(); renderAll();
        }
        reader.readAsDataURL(file);
      }
    } else if(raw){
      // handled by card drop handlers
    }
  });
}

/* ---------------------------
  Cart functions
---------------------------- */
function addToCart(prod,cat){
  const key = prod.id;
  if(!state.cart[key]) state.cart[key] = {...prod,cat, qty:1};
  else state.cart[key].qty++;
  saveState();
  showCart();
}
function updateCartUI(){
  const cartItems = document.getElementById("cartItems");
  const cartCount = document.getElementById("cartCount");
  cartItems.innerHTML = "";
  const keys = Object.keys(state.cart);
  let totalPKR = 0;
  keys.forEach(k=>{
    const it = state.cart[k];
    const row = document.createElement('div');
    row.className="row";
    row.innerHTML = `<img src="${it.img}" alt=""><div style="flex:1">
      <div style="font-weight:600">${it.title}</div>
      <div class="small-muted">PKR ${it.pkr} • $${(it.pkr/state.rate).toFixed(2)}</div>
    </div>`;
    const qtyWrap = document.createElement('div');
    qtyWrap.className = "qty";
    const minus = document.createElement('button'); minus.className='btn'; minus.textContent='-';
    const plus = document.createElement('button'); plus.className='btn'; plus.textContent='+';
    const q = document.createElement('div'); q.textContent = it.qty; q.style.padding='6px';
    minus.onclick = ()=>{
      it.qty--; if(it.qty<=0) delete state.cart[k]; saveState(); renderAll();
    };
    plus.onclick = ()=>{ it.qty++; saveState(); renderAll(); };
    qtyWrap.appendChild(minus); qtyWrap.appendChild(q); qtyWrap.appendChild(plus);
    row.appendChild(qtyWrap);
    cartItems.appendChild(row);
    totalPKR += it.pkr * it.qty;
  });
  cartCount.textContent = keys.length;
  document.getElementById("cartTotal").textContent = `PKR ${totalPKR} • $${(totalPKR/state.rate).toFixed(2)}`;
}

/* ---------------------------
  UI controls & actions
---------------------------- */
document.getElementById("openCart").addEventListener('click', showCart);
function showCart(){
  const c = document.getElementById("cartSide");
  c.style.display = c.style.display === 'none' ? 'block' : 'none';
  updateCartUI();
}
document.getElementById("clearCart").addEventListener('click', ()=>{
  state.cart = {}; saveState();
});
document.getElementById("checkoutBtn").addEventListener('click', ()=>{
  alert("Checkout is demo only — integrate a payment provider (PayPal/Stripe/JazzCash) later.");
});

/* export / import / reset */
document.getElementById("exportBtn").addEventListener('click', ()=>{
  const data = JSON.stringify(state);
  const blob = new Blob([data], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = 'fajaura-site-backup.json'; a.click();
  URL.revokeObjectURL(url);
});
document.getElementById("importBtn").addEventListener('click', ()=>{
  const input = document.createElement('input'); input.type='file'; input.accept='.json';
  input.onchange = e=>{
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = ev=>{
      try{
        const imported = JSON.parse(ev.target.result);
        state = imported; saveState(); renderAll();
        alert("Imported successfully!");
      }catch(err){ alert("Invalid file"); }
    }
    reader.readAsText(file);
  }
  input.click();
});
document.getElementById("resetBtn").addEventListener('click', ()=>{
  if(confirm("Reset demo data? This will overwrite your changes.")){
    state = { rate: DEFAULT_RATE, catalogs: createDemoProducts(), cart:{} };
    saveState(); renderAll();
  }
});

/* toggle edit mode */
let editing=false;
document.getElementById("toggleEdit").addEventListener('click', (e)=>{
  editing = !editing;
  e.target.textContent = editing ? "Disable" : "Enable";
  // when editing disabled ensure contenteditable fields locked
  renderAll();
});

/* load + render initially */
loadState();
renderAll();
</script>
</body>
</html>
